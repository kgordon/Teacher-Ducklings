<% content_for :head do -%>
	<%= javascript_include_tag 'jquery-1.3.2.min' %>
	<%= javascript_include_tag 'swfobject' %>
	<%= javascript_include_tag 'jquery.uploadify.v2.1.0.min' %>
	<%= stylesheet_link_tag 'uploadify' %>
	
	<% session_key_name = ActionController::Base.session_options[:key] -%>
	<script type="text/javascript">
		$(function(){
			$('#video_video').uploadify({
				script        : '<%= user_videos_path %>',
				uploader      : '/swf/uploadify.swf',
				fileDataName  : 'video[video]',
				auto          : 'true',
				cancelImg     : '/images/cancel.png',
				scriptData    : {
					'<%= session_key_name %>' : '<%= u cookies[session_key_name] %>',
					'authenticity_token' : encodeURIComponent('<%= u form_authenticity_token if protect_against_forgery? %>')
				}
			});
		});
	</script>
<% end -%>

<h1>Upload a Video</h1>

<div class="notice">Warning! Uploading will take some time, <strong>DO NOT</strong> keep pressing "Create,"
	this will just make it take even longer.
</div>

<% form_for @video, :url => user_videos_path(current_user), :html => { :multipart => true } do |f| %>
  <%= f.error_messages %>
	
  <p>
		<%= f.label :title, 'Title:<span class="required">*</span>' %>
		<%= f.text_field :title %>
	</p>
	<p>
  	<%= f.label :description, "Description:" %>
		<%= f.text_area :description, :rows => 5 %>
  </p>
	<p>
		<%= f.label :video, 'Video File:<span class="required">*</span>' %>
		<%= f.file_field :video %>
	</p>
  <p>
		<%= f.submit 'Upload' %>
  </p>
<% end %>